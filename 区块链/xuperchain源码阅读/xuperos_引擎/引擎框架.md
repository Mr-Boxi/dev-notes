### 引擎框架  
xupercore/kernel/engines  

engine  // 引擎工厂方法(xuperos, xchain)  
xuperos  //面向公链应用场景设计的区块链执行引擎

---
- var  
    engineMu sync.RWMutex  
    engines  = make(map[string]NewBCEngineFunc)  
    
- type  
    type NewBCEngineFunc func() BCEngine  
    
- interface  
    type BCEngine interface  //引擎基础接口  
    ```
    type BCEngine interface {
    	// 初始化引擎
    	Init(*xconf.EnvConf) error
    	// 启动引擎(阻塞)
    	Run()
    	// 退出引擎，需要幂等
    	Exit()
    }
    ```
- func  
    * func CreateBCEngine(egName string, envCfg *xconf.EnvConf) (BCEngine, error)  
    * func Register(name string, f NewBCEngineFunc)  //注册引擎创建函数
    * func newBCEngine(name string) BCEngine  
   
#### xuperos实现    
/xupercore/kernel/engines/xuperos  

引擎  
链  
链管理  
common  
config  
asyncworker  
event  
miner  
parachain  
net  
reader  
xpb  

---
- struct  
    **type Engine struct**  // xuperos执行引擎，为公链场景订制区块链引擎  
    ```
    type Engine struct {	
    	engCtx *common.EngineCtx // 引擎运行环境上下文
    	log logs.Logger          // 日志
    	chainM ChainManagerImpl  // 链管理成员
    	netEvent *xnet.NetEvent  // p2p网络事件处理	
    	relyAgent common.EngineRelyAgent  // 依赖代理组件
    	exitOnce sync.Once  // 确保Exit调用幂等
    }
    ```  
    * func NewEngine() engines.BCEngine  
    * func (t *Engine) Init(envCfg *xconf.EnvConf) error  
    * func (t *Engine) Run()  
    * func (t *Engine) Exit()   
    * func (t *Engine) Get(name string) (common.Chain, error) 
    * func (t *Engine) Stop(name string) error  
    * func (t *Engine) Context() *common.EngineCtx  
    * func (t *Engine) GetChains() []string  
    * func (t *Engine) loadChains() error  //本地加载  
    * func (t *Engine) createEngCtx(envCfg *xconf.EnvConf) (*common.EngineCtx, error)  
    * func (t *Engine) exit()   
    * func (t *Engine) LoadChain(name string) error    
    
    **type Chain struct**   // 定义一条链的具体行为  
    ```
    type Chain struct {
    	// 链上下文
    	ctx *common.ChainCtx
    	// log
    	log logs.Logger
    	// 矿工
    	miner *miner.Miner
    	// 依赖代理组件
    	relyAgent common.ChainRelyAgent
    	// 提交交易cache
    	txIdCache *cache.Cache
    }
    ```
    * func LoadChain(engCtx *common.EngineCtx, bcName string) (*Chain, error)  // 从本地存储加载链    
    * func (t *Chain) Start()  //阻塞,核心是启动矿工    
    * func (t *Chain) Stop()  // 停止矿工等其余组件    
    * func (t *Chain) Context() *common.ChainCtx  
    * func (t *Chain) PreExec(ctx xctx.XContext, reqs []*protos.InvokeRequest, initiator string, authRequires []string) (*protos.InvokeResponse, error)  //交易预执行  
    * func (t *Chain) SubmitTx(ctx xctx.XContext, tx *lpb.Transaction) error  //提交交易到交易池(xuperos引擎同时更新到状态机和交易池)  
    * func (t *Chain) ProcBlock(ctx xctx.XContext, block *lpb.InternalBlock) error  //处理P2P网络同步到的区块  
    * func (t *Chain) initChainCtx() error   // 初始化链运行依赖上下文  
    * func (t *Chain) CreateParaChain() error   //创建平行链实例  
    
    **type ChainManagerImpl struct**  // 用于管理链操作   
    ``` 
    type ChainManagerImpl struct {
    	// 链实例
    	chains  sync.Map
    	engCtx  *common.EngineCtx
    	log     logs.Logger
    }
    ``` 
    * func (m *ChainManagerImpl) Get(chainName string) (common.Chain, error)   
      根据链名获取具体链
    * func (m *ChainManagerImpl) Put(chainName string, chain common.Chain)  
    * func (m *ChainManagerImpl) Stop(chainName string) error  
    * func (m *ChainManagerImpl) GetChains() []string  
    * func (m *ChainManagerImpl) StartChains()   
    * func (m *ChainManagerImpl) StopChains()   
    * func (m *ChainManagerImpl) LoadChain(chainName string) error     
    
- func  
   
    + func EngineConvert(engine engines.BCEngine) (common.Engine, error)    
    引擎转换对外提供类型转义方法，以接口形式对外暴露  
      

#### common 公共组件模块       
定义相关接口  
定义引擎，链运行上下文  
定义统一错误     
**type Chain interface**   //定义链接口 
```
    type Chain interface {
    	// 获取链上下文
    	Context() *ChainCtx
    	// 启动链
    	Start()
    	// 关闭链
    	Stop()
    	// 合约预执行
    	PreExec(xctx.XContext, []*protos.InvokeRequest, string, []string) (*protos.InvokeResponse, error)
    	// 提交交易
    	SubmitTx(xctx.XContext, *lpb.Transaction) error
    	// 处理新区块
    	ProcBlock(xctx.XContext, *lpb.InternalBlock) error
    	// 设置依赖实例化代理
    	SetRelyAgent(ChainRelyAgent) error
    }
```
**type Engine interface**  //定义xuperos引擎对外暴露接口   
```
    type Engine interface {
    	engines.BCEngine
    	ChainManager
    	Context() *EngineCtx
    	SetRelyAgent(EngineRelyAgent) error
    }
```
**type EngineRelyAgent interface**  //定义引擎对各组件依赖接口约束      
``` 
    type EngineRelyAgent interface {
    	CreateNetwork(*xconf.EnvConf) (network.Network, error)
    }
``` 
**type ChainRelyAgent interface** // 定义链对各组件依赖接口约束  
``` 
    type ChainRelyAgent interface {
    	CreateLedger() (*ledger.Ledger, error)  
    	CreateState(*ledger.Ledger, cryptoBase.CryptoClient) (*state.State, error)
    	CreateContract(kledger.XMReader) (contract.Manager, error)
    	CreateConsensus() (consensus.ConsensusInterface, error)
    	CreateCrypto(cryptoType string) (cryptoBase.CryptoClient, error)
    	CreateAcl() (aclBase.AclManager, error)
    	CreateGovernToken() (governToken.GovManager, error)
    	CreateProposal() (propose.ProposeManager, error)
    	CreateTimerTask() (timerTask.TimerManager, error)
    }
```
**type ChainManager interface**  // 定义管理链操作接口    
``` 
    type ChainManager interface {
    	Get(string) (Chain, error)
    	GetChains() []string
    	LoadChain(string) error
    	Stop(string) error
    }
```  
**type AsyncworkerAgent interface**  
```
    // 避免循环调用
    type AsyncworkerAgent interface {
    	RegisterHandler(contract string, event string, handler TaskHandler)
    } 
```
**type TaskContext interface**   
``` 
    type TaskContext interface {
        // ParseArgs 用来解析任务参数，参数为对应任务参数类型的指针
        ParseArgs(v interface{}) error
        RetryTimes() int
    } 
``` 
type TaskHandler func(ctx TaskContext) error    
      
-
相关错误统一定义    
type Error struct  
    
-
相关上下文定义  
**type EngineCtx struct**  // 引擎运行上下文环境  
```
     type EngineCtx struct {
     	// 基础上下文
     	xctx.BaseCtx
     	// 运行环境配置
     	EnvCfg *xconf.EnvConf
     	// 引擎配置
     	EngCfg *engconf.EngineConf
     	// 网络组件句柄
     	Net network.Network
     	// 链管理上下文
     	ChainM ChainManager
     }
```
    
**type ChainCtx struct** //链级别上下文，维护链级别上下文，每条平行链各有一个  
``` 
    type ChainCtx struct {
    	// 基础上下文
    	xctx.BaseCtx
    	// 引擎上下文
    	EngCtx *EngineCtx
    	// 链名
    	BCName string
    	// 账本
    	Ledger *ledger.Ledger
    	// 状态机
    	State *state.State
    	// 合约
    	Contract contract.Manager
    	// 共识
    	Consensus consensus.ConsensusInterface
    	// 加密
    	Crypto cryptoBase.CryptoClient
    	// 权限
    	Acl aclBase.AclManager
    	// 治理代币
    	GovernToken governToken.GovManager
    	// 提案
    	Proposal propose.ProposeManager
    	// 定时任务
    	TimerTask timerTask.TimerManager
    	// 结点账户信息
    	Address *xaddress.Address
    	// 异步任务
    	Asyncworker AsyncworkerAgent
    }
```      
         
#### config  配置模块  
  
**type EngineConf struct**  
```
type EngineConf struct {
    // root chain name
    RootChain string `yaml:"rootChain,omitempty"`
    // BlockBroadcaseMode is the mode for broadcast new block
    BlockBroadcastMode uint8 `yaml:"blockBroadcastMode,omitempty"`
    // TxCacheExpiredTime expired time for tx cache
    TxIdCacheExpiredTime time.Duration `yaml:"txidCacheExpiredTime,omitempty"`
    // TxIdCacheGCInterval clean up interval for tx cache
    TxIdCacheGCInterval time.Duration `yaml:"txIdCacheGCInterval,omitempty"`
    // MaxBlockQueueSize the queue size of the processing block
    MaxBlockQueueSize int64 `yaml:"maxBlockQueueSize,omitempty"`
}

```
* func (t *EngineConf) loadConf(cfgFile string) erro  

func LoadEngineConf(cfgFile string) (*EngineConf, error)  
func GetDefEngineConf() *EngineConf  
    
    
#### agent 依赖组件代理模块  
**type ChainCoreAgent struct**  //链代理
``` 
type ChainCoreAgent struct {
    log      logs.Logger
    chainCtx *common.ChainCtx  //链上下文
}
```
* func NewChainCoreAgent(chainCtx *common.ChainCtx) *ChainCoreAgent    
* func (t *ChainCoreAgent) GetAccountAddresses(accountName string) ([]string, error) 
  // 查询合约acl      
* func (t *ChainCoreAgent) VerifyContractPermission(initiator string, authRequire []string, contractName, methodName string) (bool, error)  //结合合约acl设置鉴权  
* func (t *ChainCoreAgent) VerifyContractOwnerPermission(contractName string, authRequire []string) error  // 结合合约acl设置鉴权  
* func (t *ChainCoreAgent) QueryTransaction(txid []byte) (*pb.Transaction, error) // 查询交易    
* func (t *ChainCoreAgent) QueryBlock(blockid []byte) (ledger.BlockHandle, error)  //查询区块  

**type LedgerAgent struct**  //账本代理
``` 
type LedgerAgent struct {
    log      logs.Logger
    chainCtx *common.ChainCtx
}
```
* func NewLedgerAgent(chainCtx *common.ChainCtx) *LedgerAgent   func (t *LedgerAgent) GetNewAccountGas() (int64, error)   
* func (t *LedgerAgent) GetNewGovGas() (int64, error)   //从创世块获取治理代币消耗gas  
* func (t *LedgerAgent) GetGenesisPreDistribution() ([]ledger.Predistribution, error)  
* func (t *LedgerAgent) GetCryptoType() (string, error)  
* func (t *LedgerAgent) GetConsensusConf() ([]byte, error)   //从创世块获取共识配置  
* func (t *LedgerAgent) QueryBlock(blkId []byte) (kledger.BlockHandle, error)  
* func (t *LedgerAgent) QueryBlockByHeight(height int64) (kledger.BlockHandle, error)   
* func (t *LedgerAgent) GetTipBlock() kledger.BlockHandle  
* func (t *LedgerAgent) GetTipXMSnapshotReader() (kledger.XMSnapshotReader, error)   
* func (t *LedgerAgent) CreateSnapshot(blkId []byte) (kledger.XMReader, error)   
* func (t *LedgerAgent) GetTipSnapshot() (kledger.XMReader, error)  
* func (t *LedgerAgent) CreateXMReader() kledger.XMReader   

**type EngineRelyAgentImpl struct**  //代理依赖组件实例化操作，方便mock单测和并行开发  
```
type EngineRelyAgentImpl struct {
    engine common.Engine
} 
```
* func NewEngineRelyAgent(engine common.Engine) *EngineRelyAgentImpl   
* func (t *EngineRelyAgentImpl) CreateNetwork(envCfg *xconf.EnvConf) (network.Network, error) //创建并启动p2p网络   
**type ChainRelyAgentImpl struct**   //代理依赖组件实例化操作，方便mock单测和并行开发  
```
type ChainRelyAgentImpl struct {
    chain common.Chain
}  
``` 
* func NewChainRelyAgent(chain common.Chain) *ChainRelyAgentImpl   
* func (t *ChainRelyAgentImpl) CreateLedger() (*ledger.Ledger, error) //创建账本  
* func (t *ChainRelyAgentImpl) CreateState(leg *ledger.Ledger, crypt cryptoBase.CryptoClient) (*state.State, error) // 创建状态机  
* func (t *ChainRelyAgentImpl) CreateCrypto(cryptoType string) (cryptoBase.CryptoClient, error)   
* func (t *ChainRelyAgentImpl) CreateAcl() (aclBase.AclManager, error)   
* func (t *ChainRelyAgentImpl) CreateContract(xmreader kledger.XMReader) (contract.Manager, error)  
* func (t *ChainRelyAgentImpl) CreateConsensus() (consensus.ConsensusInterface, error)   
* func (t *ChainRelyAgentImpl) CreateGovernToken() (governToken.GovManager, error)  
* func (t *ChainRelyAgentImpl) CreateProposal() (propose.ProposeManager, error) 
* func (t *ChainRelyAgentImpl) CreateTimerTask() (timerTask.TimerManager, error)      
             
  
#### event  事件模块  
**type Topic interface**  //Topic is the factory of event Iterato  
```
type Topic interface {
    // ParseFilter 从指定的bytes buffer反序列化topic过滤器
    // 返回的参数会作为入参传递给NewIterator的filter参数
    ParseFilter(buf []byte) (interface{}, error)

    // MarshalEvent encode event payload returns from Iterator.Data()
    MarshalEvent(x interface{}) ([]byte, error)

    // NewIterator make a new Iterator base on filter
    NewIterator(filter interface{}) (Iterator, error)
} 
```  
**type Iterator interface**  
```
// Iterator is the event iterator, must be closed after use
type Iterator interface {
    Next() bool
    Data() interface{}
    Error() error
    Close()
} 
```   
**type ChainManager interface**   
```
// ChainManager manage multiple block chain
type ChainManager interface {
    // GetBlockStore get BlockStore base bcname(the name of block chain)
    GetBlockStore(bcname string) (BlockStore, error)
}
```
 
**type BlockStore interface**  
```
// BlockStore is the interface of block store
type BlockStore interface {
    // TipBlockHeight returns the tip block height
    TipBlockHeight() (int64, error)
    // WaitBlockHeight wait until the height of current block height >= target
    WaitBlockHeight(target int64) int64
    // QueryBlockByHeight returns block at given height
    QueryBlockByHeight(int64) (*pb.InternalBlock, error)
}

```

-
相关接口实现  
**type chainManager struct**  
``` 
   type chainManager struct {
        engine common.Engine
    }
```
**type blockStore struct**
```
type blockStore struct {
    *ledger.Ledger
    *state.State
}
```
**type BlockIterator struct**  
```
// BlockIterator wraps around ledger as a iterator style interface
type BlockIterator struct {
    currNum    int64
    endNum     int64
    blockStore BlockStore
    block      *pb.InternalBlock

    closed bool
    err    error
} 
```
* func NewBlockIterator(blockStore BlockStore, startNum, endNum int64) *BlockIterator  
* func (b *BlockIterator) Next() bool  
* func (b *BlockIterator) fetchBlock(num int64) (*pb.InternalBlock, error)   
* func (b *BlockIterator) Block() *pb.InternalBlock   
* func (b *BlockIterator) Data() interface{}  
* func (b *BlockIterator) Error() error  
* func (b *BlockIterator) Close()  

**type BlockTopic struct**  
```
// BlockTopic handles block events
type BlockTopic struct {
    chainmg ChainManager
} 
```
**type filteredBlockIterator struct** 
``` 
type filteredBlockIterator struct {
    biter  *BlockIterator
    filter *blockFilter
    block  *protos.FilteredBlock

    endBlockNum int64

    closed bool
    err    error
}
```
**type blockFilter struct** 
```
type blockFilter struct {
    *protos.BlockFilter
    compiled compiledBlockFilter
} 
```

**type Router struct**  
```
type Router struct {
    topics map[pb.SubscribeType]Topic
} 
```
* func NewRounterFromChainMG(chainmg ChainManager) *Router //Router from ChainManager  
* func NewRouter(engine common.Engine) *Router  // Router from common.Engine  
* func (r *Router) Subscribe(tp pb.SubscribeType, filterbuf []byte) (EncodeFunc, Iterator, error)  
* func (r *Router) RawSubscribe(tp pb.SubscribeType, filter interface{}) (Iterator, error)   
//// RawSubscribe route events from pb.SubscribeType and filter struct     

   
    
#### net  netevent模块  
**type NetEvent struct**  // 网络事件
```
type NetEvent struct {
    log      logs.Logger
    engine   common.Engine
    msgChan  chan *protos.XuperMessage
    exitChan chan bool
} 
```
* func NewNetEvent(engine common.Engine) (*NetEvent, error)  
* func (t *NetEvent) Start()   
* func (t *NetEvent) Stop()  
* func (t *NetEvent) Subscriber() error  
* func (t *NetEvent) procMsgLoop()  
* func (t *NetEvent) procAsyncMsg(request *protos.XuperMessage)  
* func (t *NetEvent) handleBatchPostTx(ctx xctx.XContext, request *protos.XuperMessage)   
* func (t *NetEvent) PostTx(ctx xctx.XContext, chain common.Chain, tx *lpb.Transaction) error   
* func (t *NetEvent) handleSendBlock(ctx xctx.XContext, request *protos.XuperMessage)   
* func (t *NetEvent) handleNewBlockID(ctx xctx.XContext, request *protos.XuperMessage)  
* func (t *NetEvent) SendBlock(ctx xctx.XContext, chain common.Chain, in *lpb.InternalBlock) error  
* func (t *NetEvent) handleGetBlock(ctx xctx.XContext,request *protos.XuperMessage) (*protos.XuperMessage, error)   
* func (t *NetEvent) handleGetChainStatus(ctx xctx.XContext, request *protos.XuperMessage) (*protos.XuperMessage, error)  
* func (t *NetEvent) handleConfirmChainStatus(ctx xctx.XContext, request *protos.XuperMessage) (*protos.XuperMessage, error)  
* func (t *NetEvent) GetBlock(ctx xctx.XContext, request *protos.XuperMessage) (*lpb.InternalBlock, error)   

func validatePostTx(tx *lpb.Transaction) error  

func validateSendBlock(block *lpb.InternalBlock) error  
    
#### parachain    平行链模块  
**type Manager struct**  
```
type Manager struct {
    Ctx *ParaChainCtx
}
```
* func NewParaChainManager(ctx *ParaChainCtx) (*Manager, error)  
 
**type ParaChainCtx struct**    
```
type ParaChainCtx struct {
    // 基础上下文
    xcontext.BaseCtx
    BcName   string
    Contract contract.Manager
    ChainCtx *common.ChainCtx
} 
```
* func NewParaChainCtx(bcName string, cctx *common.ChainCtx) (*ParaChainCtx, error)   

**type paraChainContract struct**  
```
type paraChainContract struct {
    BcName            string
    MinNewChainAmount int64
    ChainCtx          *common.ChainCtx
} 
``` 
* func NewParaChainContract(bcName string, minNewChainAmount int64, chainCtx *common.ChainCtx) *paraChainContract  
* func (p *paraChainContract) handleCreateChain(ctx common.TaskContext) error  
 创建平行链的异步事件方法，若账本不存在则创建，加载链到引擎，需幂等  
* func (p *paraChainContract) doCreateChain(bcName string, bcGenesisConfig string) error  
* func (p *paraChainContract) handleStopChain(ctx common.TaskContext) error  
 关闭平行链，仅从引擎中卸载，不处理账本，需幂等  
* func (p *paraChainContract) doStopChain(bcName string) error   
* func (p *paraChainContract) handleRefreshChain(ctx common.TaskContext) error  
* func (p *paraChainContract) createChain(ctx contract.KContext) (*contract.Response, error)  
* func (p *paraChainContract) stopChain(ctx contract.KContext) (*contract.Response, error)   
* func (p *paraChainContract) parseArgs(args map[string][]byte) (string, string, *Group, error)  
* func (p *paraChainContract) editGroup(ctx contract.KContext) (*contract.Response, error)  
* func (p *paraChainContract) getGroup(ctx contract.KContext) (*contract.Response, error)   

func loadConfig(fname string) (*ParaChainConfig, error)  
func loadGroupArgs(args map[string][]byte, group *Group) (*Group, error)  
func isContain(items []string, item string) bool   
func newContractErrResponse(status int, msg string) *contract.Response   
    
       
#### reader  读模块  对外暴露读能力  
**type ChainReader interface**  //链  
```
type ChainReader interface {
    // 获取链状态 (GetBlockChainStatus)
    GetChainStatus() (*xpb.ChainStatus, error)
    // 检查是否是主干Tip Block (ConfirmBlockChainStatus)
    IsTrunkTipBlock(blkId []byte) (bool, error)
    // 获取系统状态
    GetSystemStatus() (*xpb.SystemStatus, error)
    // 获取节点NetUR
    GetNetURL() (string, error)
    // 获取共识状态
    GetConsensusStatus() (*xpb.ConsensusStatus, error)
} 
```
**type ConsensusReader interface**   //共识  
```
type ConsensusReader interface {
    // 获取共识状态
    GetConsStatus() (consBase.ConsensusStatus, error)
    // 共识特定共识类型的操作后续统一通过合约操作
    // tdpos目前已经提供的rpc接口，看是否有业务依赖
    // 视情况决定是不是需要继续支持，需要支持走代理合约调用
} 
``` 
**type ContractReader interface**  //合约  
```
type ContractReader interface {
    // 查询该链合约统计数据
    QueryContractStatData() (*protos.ContractStatData, error)
    // 查询账户下合约状态
    GetAccountContracts(account string) ([]*protos.ContractStatus, error)
    // 查询地址下合约状态
    GetAddressContracts(addr string, needContent bool) (map[string][]*protos.ContractStatus, error)
    // 查询地址下账户
    GetAccountByAK(addr string) ([]string, error)
    // 查询合约账户ACL
    QueryAccountACL(account string) (*protos.Acl, error)
    // 查询合约方法ACL
    QueryContractMethodACL(contract, method string) (*protos.Acl, error)
    // 查询账户治理代币余额
    QueryAccountGovernTokenBalance(account string) (*protos.GovernTokenBalance, error)
} 
```

**type LedgerReader interface**  //账本  
```
type LedgerReader interface {
    // 查询交易信息（QueryTx）
    QueryTx(txId []byte) (*xpb.TxInfo, error)
    // 查询区块ID信息（GetBlock）
    QueryBlock(blkId []byte, needContent bool) (*xpb.BlockInfo, error)
    // 通过区块高度查询区块信息（GetBlockByHeight）
    QueryBlockByHeight(height int64, needContent bool) (*xpb.BlockInfo, error)
} 
```

**type UtxoReader interface**  //utxo  
``` 
type UtxoReader interface {
    // 获取账户余额
    GetBalance(account string) (string, error)
    // 获取账户冻结余额
    GetFrozenBalance(account string) (string, error)
    // 获取账户余额详情
    GetBalanceDetail(account string) ([]*lpb.BalanceDetailInfo, error)
    // 拉取固定数目的utxo
    QueryUtxoRecord(account string, count int64) (*lpb.UtxoRecordDetail, error)
    // 选择合适金额的utxo
    SelectUTXO(account string, need *big.Int, isLock, isExclude bool) (*lpb.UtxoOutput, error)
    // 按最大交易大小选择utxo
    SelectUTXOBySize(account string, isLock, isExclude bool) (*lpb.UtxoOutput, error)
}
```
---  
接口实现  
**type chainReader struct**  
``` 
type chainReader struct {
    chainCtx *common.ChainCtx
    baseCtx  xctx.XContext
    log      logs.Logger
}
```
**type consensusReader struct**  
``` 
type consensusReader struct {
    chainCtx *common.ChainCtx
    baseCtx  xctx.XContext
    log      logs.Logger
}
```
**type contractReader struct**  
``` 
type contractReader struct {
    chainCtx *common.ChainCtx
    baseCtx  xctx.XContext
    log      logs.Logger
}
```
**type ledgerReader struct**  
``` 
type ledgerReader struct {
    chainCtx *common.ChainCtx
    baseCtx  xctx.XContext
    log      logs.Logger
}
```
**type utxoReader struct**  
``` 
type utxoReader struct {
    chainCtx *common.ChainCtx
    baseCtx  xctx.XContext
    log      logs.Logger
}
```
    
#### xpb  
    
        
 